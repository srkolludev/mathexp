{"version":3,"sources":["api/order/order.controller.js"],"names":["index","userOrders","show","create","upsert","earning","destroy","userNotification","async","require","crypto","path","api_key","domain","mailgun","apiKey","respondWithResult","res","statusCode","entity","status","json","patchUpdates","patches","apply","err","reject","save","removeEntity","remove","then","end","handleEntityNotFound","handleError","send","req","find","sort","populate","exec","catch","user","id","findById","params","order","body","datedata","Date","now","push","paymentOption","message","waterfall","done","randomBytes","buffer","token","toString","httpTransport","secure","ssl","render","resolve","email","name","appName","emailHTML","mailOptions","to","from","subject","html","messages","next","_id","orderdata","notifytext","payment","findOne","setting","minOrdLoyality","point","subTotal","console","log","loyaltyDetail","credited","orderId","createdAt","loyalty","loyaltyPoints","totalLoyaltyPoints","findOneAndUpdate","new","setDefaultsOnInsert","runValidators","date","midnight","setUTCHours","nextMidnight","lastMidnight","secondLastMidnight","thirdLastMidnight","fourthLastMidnight","fifthLastMidnight","sixthLastMidnight","lastWeekMidnight","start","setDate","getDate","$gt","$lt","now1","now2","now3","now4","now5","now6","now7","i","j","temp1","temp2","temp3","temp4","temp5","temp6","temp7","sellerOrder1","sellerOrder2","sellerOrder3","sellerOrder4","sellerOrder5","sellerOrder6","sellerOrder7","data1","data2","data3","data4","data5","data6","data7","users","length","cart","itemTotalPrice","date1","getMonth","day1","label1","date2","day2","label2","date3","day3","label3","date4","day4","label4","date5","day5","label5","date6","day6","label6","date7","day7","label7","data","dataFinal","data0","labels","datasets","barData"],"mappings":"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","file":"order.controller.js","sourcesContent":["/**earning\n * Using Rails-like standard naming convention for endpoints.\n * GET     /api/orders              ->  index\n * POST    /api/orders              ->  create\n * GET     /api/orders/:id          ->  show\n * PUT     /api/orders/:id          ->  upsert\n * PATCH   /api/orders/:id          ->  patch\n * DELETE  /api/orders/:id          ->  destroy  \n */\n\n'use strict';\n\nimport jsonpatch from 'fast-json-patch';\nimport Order from './order.model';\nimport User from '../user/user.model';\nimport Setting from '../setting/setting.model';\nimport config from '../../config/environment';\n// Include NPM \nvar async = require(\"async\");\nvar crypto = require(\"crypto\");\nvar path = require(\"path\");\n\n// Email Config\n//var nodemailer = require('nodemailer');\nvar api_key = 'key-7fa9edb1b8f46cc6d5995448cd733241';\nvar domain = 'impnolife.org';\n\nvar mailgun = require('mailgun-js')({\n  apiKey: api_key, \n  domain: domain\n});\nfunction respondWithResult(res, statusCode) {\n  statusCode = statusCode || 200;\n  return function(entity) {\n    if(entity) {\n      return res.status(statusCode).json(entity);\n    }\n    return null;\n  };\n}\n\nfunction patchUpdates(patches) {\n  return function(entity) {\n    try {\n      jsonpatch.apply(entity, patches, /*validate*/ true);\n    } catch(err) {\n      return Promise.reject(err);\n    }\n\n    return entity.save();\n  };\n}\n\nfunction removeEntity(res) {\n  return function(entity) {\n    if(entity) {\n      return entity.remove()\n        .then(() => {\n          res.status(204).end();\n        });\n    }\n  };\n}\n\nfunction handleEntityNotFound(res) {\n  return function(entity) {\n    if(!entity) {\n      res.status(404).end();\n      return null;\n    }\n    return entity;\n  };\n}\n\nfunction handleError(res, statusCode) {\n  statusCode = statusCode || 500;\n  return function(err) {\n    res.status(statusCode).send(err);\n  };\n}\n\n\n// Gets a list of Orders\nexport function index(req, res) {\n  return Order.find().sort('-orderID').populate('user','name email phone').exec()\n    .then(respondWithResult(res))\n    .catch(handleError(res));\n}\n\n\n// Gets a list of Orders of a user\nexport function userOrders(req, res) {\n  return Order.find({'user':req.user.id},{}).populate('user','name email phone').exec()\n    .then(respondWithResult(res))\n    .catch(handleError(res));\n}\n// Gets a single Order from the DB\nexport function show(req, res) {\n  return Order.findById(req.params.id).populate('user','name email phone').exec()\n    .then(handleEntityNotFound(res))\n    .then(respondWithResult(res))\n    .catch(handleError(res));\n}\n\n// Creates a new Order in the DB \nexport function create(req, res) {\n  let order = new Order(req.body);\n  order.user = req.user.id;\n  let datedata = new Date();\n  datedata =  Date.now();\n  order.userNotification.push({'status':'Thank you for your order',\n  'time':datedata});\n  order.userNotification.push({'status':'Waiting for your payment to be processed.',\n  'time':datedata});\n  if(req.body.paymentOption == 'COD'){\n  order.userNotification.push({'status':'Awaiting confirmation from vendor.',\n  'time':datedata});\n  }\n  order.paymentOption = req.body.paymentOption;\n  order.save(function(err){\n    if(err){\n      res.status(400).send({\n        message:'order couldn\\'t placed.'\n      })\n    }\n    else{\n      //res.json(order);\n      async.waterfall([\n      // Generate random token\n      function (done) {\n        crypto.randomBytes(20, function (err, buffer) {\n          var token = buffer.toString('hex');\n          done(err, token);\n        });\n      },\n      // Lookup user by username\n      function (token, done, err) {\n        done(err, token);\n      },\n      function (token, done) {\n        var httpTransport = 'http://';\n        if (config.secure && config.secure.ssl === true) {\n          httpTransport = 'https://';\n        }\n        res.render(path.resolve('server/components/orderStatus/orderrequested'), {\n          email:  req.user.email,\n          name:  req.user.name,\n          appName: 'Restaurant App',\n        }, function (err, emailHTML) {\n          done(err, emailHTML);\n        });\n      },\n      // If valid email, send reset email using service\n      function (emailHTML, user, done) {\n        var mailOptions = {\n          to: req.user.email,\n          from: 'info@impnolife.org',\n          subject: 'Thank you for your order.',\n          html: emailHTML\n        };\n        mailgun.messages().send(mailOptions, function (err) {\n          if (!err) {\n            res.json(order);\n          } else {\n            return res.status(400).send({\n              message: 'Failure sending email'\n            });\n          }\n          \n        });\n      }\n      ], function (err) {\n        if (err) {\n          return next(err);\n        }\n      });\n    }\n  })\n}\n\n// Upserts the given Order in the DB at the specified ID\nexport function upsert(req, res) { \n  if(req.body._id) {\n    delete req.body._id;\n  }\n  Order.findById(req.params.id).exec(function(err,orderdata){\n    let datedata = new Date();\n    datedata =  Date.now();\n    let notifytext;\n    if(req.body.payment){\n      notifytext = 'Awaiting confirmation from vendor.';\n      orderdata.userNotification.push({'status':'Awaiting confirmation from vendor.','time':datedata})\n    }\n    if(req.body.status == 'Accepted'){\n      notifytext = 'Order Accepted by vendor.';\n      orderdata.userNotification.push({'status':'Order Accepted by vendor.','time':datedata}) \n    }\n    if(req.body.status == 'On the Way'){\n      notifytext = 'Order Accepted by vendor.';\n      orderdata.userNotification.push({'status':'Your order is on the way.','time':datedata}) \n    }\n    if(req.body.status == 'Delivered'){\n      notifytext = 'Your order has been delivered,Share your experience with us.';\n      orderdata.userNotification.push({'status':'Your order has been delivered,Share your experience with us.','time':datedata}) \n      Setting.findOne().exec(function(err,setting){\n        if(err){\n          return handleError(err,res); \n        }\n        if(!setting) {\n          return res.status(404).end();\n        }\n        var minOrdLoyality=setting.minOrdLoyality;\n        var point=0;\n        if(orderdata.subTotal >= minOrdLoyality){\n          point=point + orderdata.subTotal * 2 /100;\n          console.log(\"pppppppppp...........\"+point);\n          console.log('.........'+orderdata.subTotal)\n        }\n        else{\n          point=point;\n        }\n        let loyaltyDetail={\n          point:point,\n          credited:true,\n          orderId:orderdata._id,\n          createdAt:new Date()\n        }\n        User.findById(orderdata.user, '-salt -password').exec(function(err,loyalty){\n          if(err){\n            return handleError(err,res) \n          }\n          else{\n            loyalty.loyaltyPoints.push(loyaltyDetail);\n            loyalty.totalLoyaltyPoints=loyalty.totalLoyaltyPoints + point;\n            //loyalty.totalLoyaltyPoints\n            loyalty.save(function(err){\n            if(err){\n              return handleError(err,res);\n            }\n            else{\n              // res.json({message:\n              //   'your order is successfully placed'\n              // }).end();\n            }\n          })\n          }\n        })\n      })\n    }\n  \n    if(req.body.status == 'Cancelled'){\n      notifytext = 'Your order is cancelled,sorry for inconvenience.';\n      orderdata.userNotification.push({'status':'Your order is cancelled,sorry for inconvenience.','time':datedata}) \n    }\n    orderdata.save(function(err){\n      if(err){\n        res.status(400).send({\n          message:'order couldn\\'t placed.'\n        })\n      }\n      else{\n        //res.json(order);\n      async.waterfall([ \n\n      // Generate random token\n      function (done) {\n        crypto.randomBytes(20, function (err, buffer) {\n          var token = buffer.toString('hex');\n          done(err, token);\n        });\n      },\n      // Lookup user by username\n      function (token, done, err) {\n        done(err, token);\n      },\n      function (token, done) {\n        var httpTransport = 'http://';\n        if (config.secure && config.secure.ssl === true) {\n          httpTransport = 'https://';\n        }\n        res.render(path.resolve('server/components/orderStatus/orderrequested'), {\n          notifytext:  notifytext,\n          name:  req.user.name,\n          appName: 'Restaurant App',\n        }, function (err, emailHTML) {\n          done(err, emailHTML);\n        });\n      },\n      // If valid email, send reset email using service\n      function (emailHTML, user, done) {\n        var mailOptions = {\n          to: req.user.email,\n          from: 'info@impnolife.org',\n          subject: 'Thank you for your order.',\n          html: emailHTML\n        };\n        mailgun.messages().send(mailOptions, function (err) {\n          if (!err) {\n             Order.findOneAndUpdate({_id: req.params.id}, req.body, {new: true, upsert: true, setDefaultsOnInsert: true, runValidators: true}).exec()\n\n            .then(\n              res.json({\n                message:'order successfully updated'})\n            )\n            .catch(handleError(res));\n          } else {\n            return res.status(400).send({\n              message: 'Failure sending email'\n            });\n          }\n          \n        });\n      }\n      ], function (err) {\n        if (err) {\n          return next(err);\n        }\n      });\n      }\n    })\n  })\n}\n\n\n\n//DEVELOPMENT ZONE/////////////////////////////////////////\n// Get Seven Day Sell Info\nexport function earning(req, res) {\n  var date = new Date();\n  var midnight = date.setUTCHours(0,0,0,0);\n  var nextMidnight = midnight + 24*60*60*1000;\n  var lastMidnight = midnight -  24*60*60*1000;\n  var secondLastMidnight = midnight -  2*24*60*60*1000;\n  var thirdLastMidnight = midnight -  3*24*60*60*1000;\n  var fourthLastMidnight = midnight -  4*24*60*60*1000;\n  var fifthLastMidnight = midnight -  5*24*60*60*1000;\n  var sixthLastMidnight = midnight -  6*24*60*60*1000;\n  var lastWeekMidnight = midnight - 7*24*60*60*1000;\n  var start = new Date();\n  start.setDate(start.getDate()-7);\n  var now = new Date(Date.now());\n  Order.find({createdAt: {$gt: lastWeekMidnight, $lt: nextMidnight}},\n    {'cart.itemTotalPrice':1,'createdAt':1, '_id':0})\n  .sort({createdAt: 'descending'}).exec()\n  .then(users => {\n    var now1 = new Date();\n    now1.setDate(now1.getDate()-1);\n    var now2 = new Date();\n    now2.setDate(now2.getDate()-2);\n    var now3 = new Date();\n    now3.setDate(now3.getDate()-3);\n    var now4 = new Date();\n    now4.setDate(now4.getDate()-4);\n    var now5 = new Date();\n    now5.setDate(now5.getDate()-5);\n    var now6 = new Date();\n    now6.setDate(now6.getDate()-6);\n    var now7 = new Date();\n    now7.setDate(now7.getDate()-7);\n    var i;\n    var j;\n    // variables to store total earned price\n    var temp1 = 0;\n    var temp2 = 0;\n    var temp3 = 0;\n    var temp4 = 0;\n    var temp5 = 0;\n    var temp6 = 0;\n    var temp7 = 0;\n    //array for accessing different different days data\n    var sellerOrder1  = [];\n    var sellerOrder2  = [];\n    var sellerOrder3  = [];\n    var sellerOrder4  = [];\n    var sellerOrder5  = [];\n    var sellerOrder6  = [];\n    var sellerOrder7  = [];\n    //Arrays for holding per day collection\n    var data1  = [];\n    var data2  = []; \n    var data3  = []; \n    var data4  = []; \n    var data5  = []; \n    var data6  = []; \n    var data7  = [];\n    for(i=0; i<users.length; i++)\n    {\n      //first day\n      if(users[i].createdAt>midnight)\n      {\n        sellerOrder1.push(users[i]);\n        for(j=0; j<users[i].cart.length; j++)\n        {\n          temp1 = temp1 + users[i].cart[j].itemTotalPrice;\n        }\n      }\n      // second last day\n      else if(users[i].createdAt>lastMidnight && users[i].createdAt<midnight)\n      {\n        sellerOrder2.push(users[i]);\n        for(j=0; j<users[i].cart.length; j++)\n        {\n          temp2 = temp2 + users[i].cart[j].itemTotalPrice;\n        }\n      }\n      else if(users[i].createdAt >secondLastMidnight  && users[i].createdAt<lastMidnight)\n      {\n        sellerOrder3.push(users[i]);\n        for(j=0; j<users[i].cart.length; j++)\n        {\n          temp3 = temp3 + users[i].cart[j].itemTotalPrice;\n        }\n      }\n      else if(users[i].createdAt > thirdLastMidnight  && users[i].createdAt<secondLastMidnight)\n      {\n        sellerOrder4.push(users[i]);\n        for(j=0; j<users[i].cart.length; j++)\n        {\n          temp4 = temp4 + users[i].cart[j].itemTotalPrice;\n        }\n      }\n      else if(users[i].createdAt > fourthLastMidnight && users[i].createdAt<thirdLastMidnight )\n      {\n        sellerOrder5.push(users[i]);\n        for(j=0; j<users[i].cart.length; j++)\n        {\n          temp5 = temp5 + users[i].cart[j].itemTotalPrice;\n        }\n      }\n      else if(users[i].createdAt > fifthLastMidnight && users[i].createdAt<fourthLastMidnight)\n      {\n        sellerOrder6.push(users[i]);\n        for(j=0; j<users[i].cart.length; j++)\n        {\n          temp6 = temp6 + users[i].cart[j].itemTotalPrice;\n        }\n      }\n      else if(users[i].createdAt >sixthLastMidnight && users[i].createdAt<fifthLastMidnight)\n      {\n        sellerOrder7.push(users[i]);\n        for(j=0; j<users[i].cart.length; j++)\n        {\n          temp7 = temp7 + users[i].cart[j].itemTotalPrice;\n        }\n      }\n      else (users[i].createdAt <0)\n      {\n      }\n    }\n    var date1 = now1.getMonth();\n    date1++;\n    var day1 = now1.getDate();\n    let label1 =date1 + '/' +day1;\n    var date2 = now2.getMonth();\n    date2++;\n    var day2 = now2.getDate();\n    let label2 =date2 + '/' +day2;\n    var date3 = now3.getMonth();\n    date3++;\n    var day3 = now3.getDate();\n    let label3 =date3 + '/' +day3;\n    var date4 = now4.getMonth();\n    date4++;\n    var day4 = now4.getDate();\n    let label4 =date4 + '/' +day4;\n    var date5 = now5.getMonth();\n    date5++;\n    var day5 = now5.getDate();\n    let label5 =date5 + '/' +day5;\n    var date6 = now6.getMonth();\n    date6++;\n    var day6 = now6.getDate();\n    let label6 =date6 + '/' +day6;\n    var date7 = now7.getMonth();\n    date7++;\n    var day7 = now7.getDate();\n    let label7 =date7 + '/' +day7;\n    data1.push(label1);\n    data2.push(temp1);\n    data1.push(label2);\n    data2.push(temp2);\n    data1.push(label3);\n    data2.push(temp3);\n    data1.push(label4);\n    data2.push(temp4);\n    data1.push(label5);\n    data2.push(temp5);\n    data1.push(label6);\n    data2.push(temp6);\n    data1.push(label7);\n    data2.push(temp7);\n    var data = {\n      data:data2\n    }\n    var dataFinal = [];\n    dataFinal.push(data);\n    var data0 = {\n      labels:data1,\n      datasets:dataFinal\n    }\n    var barData = {\n      barData:data0\n    }\n    res.status(200).json(barData);\n  })\n  .catch(handleError(res));\n}\n\n// Deletes a Order from the DB\nexport function destroy(req, res) {\n  return Order.findById(req.params.id).exec()\n    .then(handleEntityNotFound(res))\n    .then(removeEntity(res))\n    .catch(handleError(res));\n}\n\n\n// user notification from the DB\nexport function userNotification(req, res) {\n  return Order.findById(req.params.id,'userNotification shippingAddress').exec(function(err,data){\n    if(err){\n      return handleError(res,err);\n    }\n    else{\n      res.json(data);\n    }\n  }) \n}"]}